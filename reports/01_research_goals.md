# 연구 목표

## 1. 연구 제목

**GAIN-MTL: Guided Attention Inference Multi-Task Learning을 활용한 해석 가능한 제조 결함 검출**

---

## 2. 연구의 핵심 질문

> 딥러닝 분류 모델이 **올바른 근거**로 제조 결함을 판정하도록 만들 수 있는가?

---

## 3. 문제 정의

### 3.1 현재 상황

기존 딥러닝 기반 제조 결함 검출 모델은 **분류 정확도**는 높지만, CAM(Class Activation Map)을 확인하면 **결함과 무관한 영역을 보고 판정**하는 경우가 빈번하다.

```
[실험 결과 — Strategy 1 (Baseline)]
  분류 정확도:  87.8%   ← 높은 정확도
  CAM-IoU:     11.6%   ← 결함 영역과 거의 무관한 attention
  PointGame:   16.1%   ← 최대 activation이 결함 내부에 있는 비율 극히 낮음
```

이는 모델이 **결함 자체가 아닌 배경 패턴, 텍스처 등 우연적 상관관계(spurious correlation)**에 의존하여 판정하고 있음을 의미한다.

### 3.2 왜 문제인가

| 문제 | 설명 |
|------|------|
| **신뢰성 부족** | 모델이 올바른 근거 없이 판정하므로, 새로운 환경에서 성능 저하 위험 |
| **해석 불가** | 현장 운영자가 모델의 판단 근거를 확인할 수 없어 실전 배포가 어려움 |
| **일반화 실패** | 학습 데이터의 편향(bias)에 의존하면 데이터 분포 변화 시 성능 급감 |
| **품질 관리 한계** | 결함 "위치"를 알 수 없으면 후속 공정 개선에 활용 불가 |

---

## 4. 연구 목표

### 목표 1: 해석 가능한 결함 분류 모델 구축

Detection label(결함 위치 마스크)을 활용하여 모델의 attention이 **실제 결함 영역**과 일치하도록 학습시키는 프레임워크를 개발한다.

- **입력**: 제품 이미지 + 결함 위치 마스크(binary mask)
- **출력**: 양품/불량 분류 결과 + 결함 위치 attention map
- **핵심 지표**: CAM-IoU (attention map과 GT mask의 Intersection over Union)

### 목표 2: 분류 성능과 해석 가능성의 동시 향상

분류 정확도를 유지하면서도 모델의 해석 가능성(interpretability)을 극대화하는 multi-task learning 구조를 설계한다.

| 지표 | Baseline (S1) | 목표 |
|------|---------------|------|
| 분류 정확도 (Accuracy) | 87.8% | 유지 또는 향상 |
| 분류 F1-Score | 89.7% | 유지 또는 향상 |
| CAM-IoU | 11.6% | **대폭 향상** (4배 이상) |
| PointGame | 16.1% | **대폭 향상** |
| Energy-Inside | 10.9% | **대폭 향상** |

### 목표 3: 단계적 학습 전략의 효과 검증

각 구성 요소(CAM Guidance, Attention Mining, Localization, Counterfactual)가 성능과 해석 가능성에 미치는 영향을 **단계적으로 분석**한다.

| 단계 | 추가 요소 | 검증 내용 |
|------|-----------|-----------|
| S1 | Classification Only | Baseline 성능 및 "올바르지 않은 근거" 문제 확인 |
| S2 | + CAM Guidance | 직접적인 CAM supervision의 효과 |
| S3 | + Attention Mining | 학습 가능한 attention 모듈의 기여 |
| S4 | + Localization | 결함 위치 segmentation의 보조 효과 |
| S5 | + Counterfactual | 반사실적 추론의 분류 강건성 기여 |

### 목표 4: 실전 배포 가능한 모델 선정 기준 제시

다양한 전략의 성능을 비교 분석하여, **제조 현장에서 실질적으로 활용 가능한 모델 선정 기준**을 제시한다.

- 분류 성능(Recall 중심) vs 해석 가능성(CAM-IoU) 간의 트레이드오프 분석
- 결함 미검출(FN)이 오검출(FP)보다 위험한 제조 환경 특성 반영
- 현장 운영자가 판단 근거를 확인할 수 있는 수준의 attention 품질 확보

---

## 5. 기대 효과

```
[Baseline → GAIN-MTL (Full)]

분류 성능:     87.8% → 88.9% (Accuracy)     +1.1%p
               89.7% → 90.5% (F1-Score)     +0.8%p
               86.1% → 90.0% (Recall)        +3.9%p

해석 가능성:   11.6% → 46.5% (CAM-IoU)      4.0x 향상
               16.1% → 88.6% (PointGame)     5.5x 향상
               10.9% → 68.3% (Energy-Inside) 6.3x 향상
```

- **분류 정확도를 유지하면서 모델 해석 가능성을 4~6배 향상**
- 모델이 실제 결함 영역을 보고 판단한다는 것을 정량적으로 입증
- 제조 현장에서의 AI 모델 신뢰성 및 활용도 제고

---

## 6. 연구 범위

### 포함

- EfficientNetV2 기반 분류 모델 구축 및 학습
- GAIN 기반 Guided Attention 메커니즘 구현
- Multi-Task Learning (분류 + 위치 추정) 프레임워크 설계
- Counterfactual 학습을 통한 추론 강건성 검증
- 6가지 학습 전략(S1~S6)의 비교 실험 및 분석

### 제외

- 실시간 추론 속도 최적화 (모델 경량화, 양자화 등)
- 다중 결함 유형 분류 (양품/불량 2-class 분류로 한정)
- 3D 결함 검출 또는 비전 이외의 센서 데이터 활용
